<shaders>
  <shader name="BlackHole">
    <parameters>
      <param name="Enabled" type="float" default="1.0" min="0.0" max="1.0" step="0.1"/>
      <param name="BlackPosition" type="vec3" default="240,135,50"/>
      <param name="Time" type="float" studioType="time"/>
    </parameters>
    <vertex><![CDATA[
attribute vec3 Position;
attribute vec4 Color;
attribute vec2 TexCoord;
attribute vec4 RenderData;
attribute float Scale;

attribute float Enabled;
attribute vec3 BlackPosition;
attribute float Time;

uniform mat4 Transform;

varying vec4 Color0;
varying vec2 TexCoord0;
varying vec4 RenderDataOut;
varying float ScaleOut;

varying float EnabledOut;
varying vec3 BlackPositionOut;
varying float TimeOut;

void main(void) {
    Color0 = Color;
    TexCoord0 = TexCoord;
    RenderDataOut = RenderData;
    ScaleOut = Scale;
    EnabledOut = Enabled;
    BlackPositionOut = BlackPosition;
    TimeOut = Time;
    gl_Position = Transform * vec4(Position.xyz, 1.0);
}
    ]]></vertex>
    <fragment><![CDATA[
varying lowp vec4 Color0;
varying mediump vec2 TexCoord0;
varying lowp vec4 RenderDataOut;
varying lowp float ScaleOut;

varying lowp float EnabledOut;
varying lowp vec3 BlackPositionOut;
varying lowp float TimeOut;

uniform sampler2D Texture0;

void main(void) {
    float aspect = RenderDataOut.z / RenderDataOut.w;
    vec4 Color = Color0 * texture2D(Texture0, TexCoord0);

    vec2 pos = (BlackPositionOut.xy / RenderDataOut.zw) * ScaleOut;
    vec2 rad = (BlackPositionOut.zy / RenderDataOut.zw) * ScaleOut * 1.02;

    float radius = length((rad - pos) * vec2(aspect, 1.0));
    float dist = length((TexCoord0 - pos) * vec2(aspect, 1.0));

    if (dist < radius * TimeOut) {
        Color.rgb -= EnabledOut * Color.rgb;
    }
    gl_FragColor = Color;
}
    ]]></fragment>
  </shader>
</shaders>
